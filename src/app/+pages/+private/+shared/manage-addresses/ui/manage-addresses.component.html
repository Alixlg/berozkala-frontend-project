<div class="max-w-4xl px-4 py-10 sm:px-6 lg:px-8 mx-auto">
  <div class="bg-white rounded-xl shadow-xs p-4 sm:p-7 dark:bg-neutral-800">
    <div class="mb-8">
      <h2 class="text-xl font-bold text-gray-800 dark:text-neutral-200">مدیریت آدرس‌ها</h2>
      <p class="text-sm text-gray-600 dark:text-neutral-400">افزودن، ویرایش یا حذف آدرس‌های شما.</p>
    </div>

    <form (submit)="submitChanges()">
      <div class="space-y-6">

        <!-- تکرار لیست آدرس‌ها -->
        @for (address of allAddresses; track $index) {
        <div
          class="border border-gray-200 dark:border-neutral-800 rounded-lg p-4 bg-gray-300 dark:bg-neutral-900 relative">

          <button type="button" class="absolute top-2 left-2 text-red-500 hover:text-red-700 text-sm font-semibold"
            (click)="removeAddress(address)">
            حذف
          </button>

          <div class="grid sm:grid-cols-12 gap-4">

            <!-- آدرس -->
            <div class="sm:col-span-12">
              <label for="addressBody-{{$index}}" class="block text-sm text-gray-800 dark:text-neutral-200">آدرس</label>
              <textarea id="addressBody-{{$index}}" name="addressBody-{{$index}}" [(ngModel)]="address.addressBody"
                placeholder="مثلاً تهران، خیابان آزادی، پلاک ۱۲۳" class="py-2.5 px-3 block w-full border-gray-200 rounded-lg shadow-2xs sm:text-sm
                       bg-white placeholder-gray-400 mt-2
                       focus:border-green-500 focus:ring-green-500
                       dark:bg-neutral-800 dark:border-neutral-700
                       dark:text-neutral-300 dark:placeholder-neutral-500 dark:focus:ring-neutral-600"></textarea>
            </div>

            <!-- کد پستی -->
            <div class="sm:col-span-6">
              <label for="postalCode-{{$index}}" class="block text-sm text-gray-800 mt-2 dark:text-neutral-200">کد
                پستی</label>
              <input id="postalCode-{{$index}}" name="postalCode-{{$index}}" [(ngModel)]="address.postalCode"
                type="text" placeholder="1234567890" class="py-2.5 px-3 block w-full border-gray-200 rounded-lg shadow-2xs sm:text-sm
                       bg-white placeholder-gray-400 mt-2
                       focus:border-green-500 focus:ring-green-500
                       dark:bg-neutral-800 dark:border-neutral-700
                       dark:text-neutral-300 dark:placeholder-neutral-500 dark:focus:ring-neutral-600" />
            </div>

            <!-- شماره تلفن -->
            <div class="sm:col-span-6">
              <label for="phoneNumber-{{$index}}" class="block text-sm text-gray-800 mt-2 dark:text-neutral-200">شماره
                تلفن</label>
              <input id="phoneNumber-{{$index}}" name="phoneNumber-{{$index}}" [(ngModel)]="address.phoneNumber"
                type="text" placeholder="09121234567" class="py-2.5 px-3 block w-full border-gray-200 rounded-lg shadow-2xs sm:text-sm
                       bg-white placeholder-gray-400 mt-2
                       focus:border-green-500 focus:ring-green-500
                       dark:bg-neutral-800 dark:border-neutral-700
                       dark:text-neutral-300 dark:placeholder-neutral-500 dark:focus:ring-neutral-600" />
            </div>
          </div>
        </div>
        }

        <!-- دکمه افزودن آدرس جدید -->
        <div class="flex justify-start">
          <button type="button" (click)="addNewAddress()"
            class="py-2 px-4 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-green-500
                   text-green-600 hover:bg-green-50 dark:hover:bg-neutral-700 focus:outline-hidden focus:ring-2 focus:ring-green-500">
            افزودن آدرس جدید
          </button>
        </div>

        <!-- دکمه ذخیره -->
        <div class="mt-6 flex justify-end">
          <button type="submit" [disabled]="addressesAddModel.length === 0 && addressesEditModel.length === 0" class="py-2.5 px-6 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-transparent
            bg-green-600 text-white hover:bg-green-700 focus:outline-hidden focus:bg-green-700
            disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-400">
            @if (!isBussy) {
            ذخیره تغییرات
            }
            @else {
            <span
              class="animate-spin inline-block size-4 border-3 border-current border-t-transparent text-neutral-50 rounded-full"
              role="status" aria-label="loading">
            </span>
            }
          </button>
        </div>

      </div>
    </form>
  </div>
</div>
